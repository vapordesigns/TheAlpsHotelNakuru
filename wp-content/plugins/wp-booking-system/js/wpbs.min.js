function showLoader(e){e.find(".wpbs-loading").fadeTo(0,0).css("display","block").fadeTo(200,1),e.find(".wpbs-calendar ul").animate({opacity:"0.7"},200)}function hideLoader(){wpbs(".wpbs-loading").css("display","none")}function wpbs_changeDay(e,t,a){var s={action:"wpbs_changeDay",calendarDirection:e,totalCalendars:a.find(".wpbs-total-calendars").html(),currentTimestamp:t,calendarData:a.find(".wpbs-calendar-data").attr("data-info"),calendarHistory:a.find(".wpbs-calendar-history").html(),calendarLegend:a.find(".wpbs-calendar-legend").attr("data-info"),showDropdown:a.find(".wpbs-show-dropdown").html(),calendarLanguage:a.find(".wpbs-calendar-language").html(),weekStart:a.find(".wpbs-calendar-week-start").html(),showTooltip:a.find(".wpbs-calendar-tooltip").html(),calendarSelection:a.find(".wpbs-calendar-selection").html(),calendarSelectionType:a.find(".wpbs-calendar-selection-type").html(),autoPending:a.find(".wpbs-calendar-auto-pending").html(),weekNumbers:a.find(".wpbs-calendar-week-numbers").html(),minDays:a.find(".wpbs-calendar-minumum-days").html(),maxDays:a.find(".wpbs-calendar-maximum-days").html(),jump:a.find(".wpbs-calendar-jump").html(),calendarID:a.find(".wpbs-calendar-ID").html(),formID:a.find(".wpbs-calendar-form-ID").html(),formPosition:a.find(".wpbs-calendar-form-position").html()};wpbs.post(ajaxurl,s,function(e){a.find(".wpbs-calendars").html(e),hideLoader()})}function wpbs_clear_selection(){startDate=endDate=!1,wpbs(".wpbs-not-bookable").removeClass("wpbs-not-bookable").addClass("wpbs-bookable"),wpbs(".wpbs-bookable-clicked").removeClass("wpbs-bookable-clicked"),wpbs(".wpbs-bookable-hover").removeClass("wpbs-bookable-hover"),wpbs(".wpbs-selected").removeClass("wpbs-selected"),wpbs(".wpbs-start-date, .wpbs-end-date").val(""),wpbs(".wpbs-calendar-selection").html("")}var wpbs=jQuery.noConflict(),onloadCallback=function(){wpbs("span.zn-recaptcha").each(function(e,t){grecaptcha.render(t,{sitekey:recaptcha_public})})},startDate=!1,endDate=!1,checkselectedDays=function(){var e,t=null,a=wpbs(".wpbs-form-form .wpbs-start-date").val(),s=wpbs(".wpbs-form-form .wpbs-end-date").val();if(!a)return!1;if(!s)return!1;a.length>0&&(e=wpbs('[data-timestamp="'+parseInt(wpbs(".wpbs-form-form .wpbs-start-date").val())+'"]').data("order")),s.length>0&&(t=wpbs('[data-timestamp="'+parseInt(wpbs(".wpbs-form-form .wpbs-end-date").val())+'"]').data("order"));for(var r=e;r<=t;r++)wpbs('[data-order=" '+parseInt(r)+' "]').addClass("wpbs-bookable-hover").removeClass("wpbs-bookable")};wpbs(document).ready(function(){checkselectedDays(),wpbs("div.wpbs-container li[data-tooltip]").each(function(){wpbs(this).on("mouseover",function(){})}),wpbs("div.wpbs-container").each(function(){var e=wpbs(this);wpbs(e).on("change",".wpbs-dropdown",function(t){showLoader(e),t.preventDefault(),wpbs_changeDay("jump",wpbs(this).val(),e)}),wpbs(e).on("click",".wpbs-prev",function(t){showLoader(e),t.preventDefault(),0==e.find(".wpbs-current-timestamp a").length?timestamp=e.find(".wpbs-current-timestamp").html():timestamp=e.find(".wpbs-current-timestamp a").html(),wpbs_changeDay("prev",timestamp,e)}),wpbs(e).on("click",".wpbs-next",function(t){showLoader(e),t.preventDefault(),0==e.find(".wpbs-current-timestamp a").length?timestamp=e.find(".wpbs-current-timestamp").html():timestamp=e.find(".wpbs-current-timestamp a").html(),wpbs_changeDay("next",timestamp,e)}),wpbs(e).on("click",".wpbs-form-submit",function(t){t.preventDefault(),e.find(".wpbs-form-loading").fadeTo(0,0).css("display","block").fadeTo(200,1),e.find(".wpbs-form-item").animate({opacity:"0.7"},200);var a=wpbs('a[name="wpbs-form-start"]');wpbs("html,body").animate({scrollTop:a.offset().top},"slow");var s=e.find(".wpbs-form-form").serialize();s="action=wpbs_submitForm&"+s,wpbs.post(ajaxurl,s,function(t){e.find(".wpbs-form-form").html(t),$("#recaptcha-"+e.find(".wpbs-form-form").data("id")+"-"+e.find(".wpbs-form-form").data("calendar-id")).length>0&&grecaptcha.render("recaptcha-"+e.find(".wpbs-form-form").data("id")+"-"+e.find(".wpbs-form-form").data("calendar-id"),{sitekey:recaptcha_public})})}),"multiple"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&(wpbs(e).on("click",".wpbs-bookable",function(t){t.preventDefault(),$this=wpbs(this),0==startDate?(wpbs_clear_selection(),$this.addClass("wpbs-bookable-clicked"),e.find(".wpbs-start-date").val($this.attr("data-timestamp")),startDate=!0,e.find(".wpbs-calendar-selection").html(e.find(".wpbs-start-date").val()+"-0")):0==endDate&&($this.addClass("wpbs-bookable-clicked"),e.find(".wpbs-end-date").val($this.attr("data-timestamp")),e.find(".wpbs-not-bookable").removeClass("wpbs-not-bookable").addClass("wpbs-bookable"),endDate=!0,startDate=!1,e.find(".wpbs-calendar-selection").html(e.find(".wpbs-start-date").val()+"-"+e.find(".wpbs-end-date").val()))}),wpbs(e).find(".wpbs-calendars").mouseleave(function(){wpbs(e).find(".wpbs-bookable-clicked").length})),"single"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&wpbs(e).on("click",".wpbs-bookable",function(t){t.preventDefault(),$this=wpbs(this),wpbs_clear_selection(),wpbs(this).addClass("wpbs-bookable-clicked"),e.find(".wpbs-start-date").val($this.attr("data-timestamp")),e.find(".wpbs-end-date").val($this.attr("data-timestamp")),e.find(".wpbs-not-bookable").removeClass("wpbs-not-bookable").addClass("wpbs-bookable"),endDate=!1,startDate=!1,e.find(".wpbs-calendar-selection").html(e.find(".wpbs-start-date").val()+"-"+e.find(".wpbs-end-date").val())}),"fixed"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&wpbs(e).on("click",".wpbs-bookable",function(t){for(t.preventDefault(),$this=wpbs(this),wpbs_clear_selection(),startHover=parseInt($this.data("order")),endHover=startHover+6,selectable=!0,i=startHover;i<=endHover;i++)if(elem=e.find(".wpbs-bookable-"+i),elem.hasClass("status-1"))return alert("There is already booked date in this range!"),selectable=!1,!1;if(selectable){for(wpbs(this).addClass("wpbs-bookable-clicked"),i=startHover;i<=endHover;i++)elem=e.find(".wpbs-bookable-"+i),elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-selected");endElem=e.find(".wpbs-selected").last(),e.find(".wpbs-start-date").val($this.attr("data-timestamp")),e.find(".wpbs-end-date").val(endElem.attr("data-timestamp")),e.find(".wpbs-not-bookable").removeClass("wpbs-not-bookable").addClass("wpbs-bookable"),endDate=!1,startDate=!1,e.find(".wpbs-calendar-selection").html(e.find(".wpbs-start-date").val()+"-"+e.find(".wpbs-end-date").val())}}),"week"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&wpbs(e).on("click",".wpbs-bookable",function(t){if(t.preventDefault(),$this=wpbs(this),wpbs_clear_selection(),currentWeek=$this.parent("ul"),selectable=!0,expandedSelection=!1,currentWeek.children("li").each(function(){if(elem=wpbs(this),elem.hasClass("wpbs-disabled"))return alert("There is already booked date in this range!"),selectable=!1,!1;elem.hasClass("wpbs-pad")&&(expandedSelection=!0)}),selectable&&!expandedSelection&&(wpbs(this).addClass("wpbs-bookable-clicked"),currentWeek.children("li").each(function(){elem=wpbs(this),(elem.hasClass("wpbs-bookable")||elem.hasClass("status-default"))&&elem.addClass("wpbs-selected")})),currentWeek=$this.parent("ul"),hoverable=!0,expandedSelection=!1,currentWeek.children("li").each(function(){if(elem=wpbs(this),elem.hasClass("status-1")||elem.hasClass("wpbs-disabled"))return hoverable=!1,!1;hoverable&&elem.hasClass("wpbs-pad")&&(expandedSelection=!0)}),hoverable&&expandedSelection)for(currentWeekStart=currentWeek.children("li:not(.wpbs-week-number):not(.wpbs-pad)").first(),firstItem=currentWeek.children("li:not(.wpbs-week-number)").first(),onwords=!0,firstItem.hasClass("wpbs-pad")&&(onwords=!1),onwords?(hoverStart=currentWeekStart.data("order"),hoverEnd=hoverStart+6):(newfirstItem=currentWeek.children("li:not(.wpbs-week-number)").last(),hoverEnd=newfirstItem.data("order")+1,hoverStart=hoverEnd-7),i=hoverStart;i<=hoverEnd;i++)elem=e.find(".wpbs-bookable-"+i),elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-selected");selectionStart=currentWeek.find("li.wpbs-selected").first(),selectionEnd=currentWeek.find("li.wpbs-selected").last(),selectionEnd.hasClass("wpbs-pad")&&(selectionEnd=currentWeek.find("li.wpbs-bookable").last()),e.find(".wpbs-start-date").val(selectionStart.attr("data-timestamp")),e.find(".wpbs-end-date").val(selectionEnd.attr("data-timestamp")),e.find(".wpbs-not-bookable").removeClass("wpbs-not-bookable").addClass("wpbs-bookable"),endDate=!1,startDate=!1,e.find(".wpbs-calendar-selection").html(selectionStart.attr("data-timestamp")+"-"+selectionEnd.attr("data-timestamp"))});var t=function(e,t){return!!e.hasClass("status-1")&&(t&&alert("There is already booked date in this range!"),!0)},a=function(){e.find(".wpbs-selected").each(function(){wpbs(this).removeClass("wpbs-selected")})};"8days"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&wpbs(e).on("click",".wpbs-bookable",function(s){s.preventDefault(),$this=wpbs(this),wpbs_clear_selection();if(currentWeek=$this.parent("ul"),selectable=!0,expandedSelection=!1,currentWeek.children("li").each(function(){if(elem=wpbs(this),t(elem,!1))return!1;elem.hasClass("wpbs-pad")&&(expandedSelection=!0)}),selectable&&!expandedSelection)for(currentWeekStart=currentWeek.children("li:not(.wpbs-week-number):not(.wpbs-pad)").first(),firstItem=currentWeek.children("li:not(.wpbs-week-number)").first(),onwords=!0,firstItem.hasClass("wpbs-pad")&&(onwords=!1),onwords?(hoverStart=currentWeekStart.data("order"),hoverEnd=hoverStart+7):(newfirstItem=currentWeek.children("li:not(.wpbs-week-number)").last(),hoverEnd=newfirstItem.data("order")+1,hoverStart=hoverEnd-7),i=hoverStart;i<=hoverEnd;i++)elem=e.find(".wpbs-bookable-"+i),elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-selected");if(currentWeek=$this.parent("ul"),hoverable=!0,expandedSelection=!1,currentWeek.children("li").each(function(){if(elem=wpbs(this),t(elem,!1))return!1;hoverable&&elem.hasClass("wpbs-pad")&&(expandedSelection=!0)}),hoverable&&expandedSelection)for(currentWeekStart=currentWeek.children("li:not(.wpbs-week-number):not(.wpbs-pad)").first(),firstItem=currentWeek.children("li:not(.wpbs-week-number)").first(),onwords=!0,firstItem.hasClass("wpbs-pad")&&(onwords=!1),onwords?(hoverStart=currentWeekStart.data("order"),hoverEnd=hoverStart+7):(newfirstItem=currentWeek.children("li:not(.wpbs-week-number)").last(),hoverEnd=newfirstItem.data("order")+1,hoverStart=hoverEnd-7),i=hoverStart;i<=hoverEnd;i++){if(elem=e.find(".wpbs-bookable-"+i),t(elem,!1)){a();break}elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-selected")}selectionStart=e.find("li.wpbs-selected").first(),selectionEnd=e.find("li.wpbs-selected").last(),selectionEnd.hasClass("wpbs-pad")&&(selectionEnd=currentWeek.find("li.wpbs-bookable").last()),e.find(".wpbs-start-date").val(selectionStart.attr("data-timestamp")),e.find(".wpbs-end-date").val(selectionEnd.attr("data-timestamp")),e.find(".wpbs-not-bookable").removeClass("wpbs-not-bookable").addClass("wpbs-bookable"),endDate=!1,startDate=!1,e.find(".wpbs-calendar-selection").html(selectionStart.attr("data-timestamp")+"-"+selectionEnd.attr("data-timestamp"))}),wpbs(e).on("mouseenter",".wpbs-bookable",function(a){a.preventDefault(),$this=wpbs(this);if(0==e.find(".wpbs-bookable-clicked").length&&e.find(".wpbs-bookable-hover").removeClass("wpbs-bookable-hover"),"week"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&(e.find(".wpbs-bookable-hover").removeClass("wpbs-bookable-hover"),currentWeek=$this.parent("ul"),hoverable=!0,expandedSelection=!1,currentWeek.children("li").each(function(){if(elem=wpbs(this),elem.hasClass("status-1")||elem.hasClass("wpbs-disabled"))return hoverable=!1,!1;hoverable&&elem.hasClass("wpbs-pad")&&(expandedSelection=!0)}),hoverable&&!expandedSelection&&currentWeek.children("li").each(function(){elem=wpbs(this),(elem.hasClass("wpbs-bookable")||elem.hasClass("status-default"))&&elem.addClass("wpbs-bookable-hover")}),hoverable&&expandedSelection))for(currentWeekStart=currentWeek.children("li:not(.wpbs-week-number):not(.wpbs-pad)").first(),firstItem=currentWeek.children("li:not(.wpbs-week-number)").first(),onwords=!0,firstItem.hasClass("wpbs-pad")&&(onwords=!1),onwords?(hoverStart=currentWeekStart.data("order"),hoverEnd=hoverStart+6):(newfirstItem=currentWeek.children("li:not(.wpbs-week-number)").last(),hoverEnd=newfirstItem.data("order"),hoverStart=hoverEnd-6),i=hoverStart;i<=hoverEnd;i++)elem=e.find(".wpbs-bookable-"+i),elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-bookable-hover");if("fixed"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&(e.find(".wpbs-bookable-hover").removeClass("wpbs-bookable-hover"),startHover=parseInt($this.data("order")),endHover=startHover+6,selectable=!0,selectable))for(i=startHover;i<=endHover;i++)elem=e.find(".wpbs-bookable-"+i),elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-bookable-hover");if("multiple"==wpbs(e).find(".wpbs-calendar-selection-type").html()&&1==startDate&&0==endDate)for(e.find(".wpbs-bookable-hover").removeClass("wpbs-bookable-hover"),e.find(".wpbs-bookable-clicked").length>0&&(startHover=parseInt(e.find(".wpbs-bookable-clicked").attr("data-order"))),endHover=parseInt(wpbs(this).attr("data-order")),startHover>endHover?(startHoverSelection=endHover,endHoverSelection=startHover,reverse=!0):(startHoverSelection=startHover,endHoverSelection=endHover,reverse=!1),i=startHoverSelection;i<=endHoverSelection;i++)e.find(".wpbs-bookable-"+parseInt(i)).length>0&&e.find(".wpbs-bookable-"+parseInt(i)).hasClass("wpbs-bookable")?e.find(".wpbs-bookable-"+parseInt(i)).addClass("wpbs-bookable-hover"):e.find(".wpbs-bookable-"+parseInt(i)).length>0&&e.find(".wpbs-bookable").each(function(){reverse?parseInt(wpbs(this).attr("data-order"))<=i&&wpbs(this).addClass("wpbs-not-bookable").removeClass("wpbs-bookable wpbs-bookable-hover"):parseInt(wpbs(this).attr("data-order"))>i&&wpbs(this).addClass("wpbs-not-bookable").removeClass("wpbs-bookable wpbs-bookable-hover")});if("8days"==wpbs(e).find(".wpbs-calendar-selection-type").html()){if(e.find(".wpbs-bookable-hover").removeClass("wpbs-bookable-hover"),currentWeek=$this.parent("ul"),hoverable=!0,expandedSelection=!1,currentWeek.children("li").each(function(){elem=wpbs(this),hoverable&&elem.hasClass("wpbs-pad")&&(expandedSelection=!0)}),hoverable&&!expandedSelection)for(currentWeekStart=currentWeek.children("li:not(.wpbs-week-number):not(.wpbs-pad)").first(),firstItem=currentWeek.children("li:not(.wpbs-week-number)").first(),hoverStart=currentWeekStart.data("order"),hoverEnd=hoverStart+7,i=hoverStart;i<=hoverEnd;i++){if(elem=e.find(".wpbs-bookable-"+i),t(elem,!1))return!1;elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-bookable-hover")}if(hoverable&&expandedSelection)for(currentWeekStart=currentWeek.children("li:not(.wpbs-week-number):not(.wpbs-pad)").first(),firstItem=currentWeek.children("li:not(.wpbs-week-number)").first(),onwords=!0,firstItem.hasClass("wpbs-pad")&&(onwords=!1),onwords?(hoverStart=currentWeekStart.data("order"),hoverEnd=hoverStart+7):(newfirstItem=currentWeek.children("li:not(.wpbs-week-number)").last(),hoverEnd=newfirstItem.data("order")+1,hoverStart=hoverEnd-7),i=hoverStart;i<=hoverEnd;i++){if(elem=e.find(".wpbs-bookable-"+i),t(elem,!1))return!1;elem.hasClass("wpbs-bookable")&&elem.addClass("wpbs-bookable-hover")}}})}),wpbs("div.wpbs-container").on("mouseenter","li.wpbs-day",function(){if($li=wpbs(this),void 0!==$li.attr("data-tooltip")){$li.addClass("wpbs-tooltip-active"),$li.append('<div class="wpbs-tooltip"><strong>'+$li.attr("data-tooltip-date")+"</strong>"+$li.attr("data-tooltip")+"</div>");var e=($li.height(),$(window).width()-($li.offset().left+$li.outerWidth()));e>154&&e<190&&$(".wpbs-tooltip").css({top:"33px",left:"-80px"}),e<154&&e>10&&$(".wpbs-tooltip").css({left:"-195px"})}}),wpbs("div.wpbs-container").on("mouseleave","li.wpbs-day",function(){wpbs(".wpbs-tooltip-active").removeClass("wpbs-tooltip-active"),wpbs("li.wpbs-day .wpbs-tooltip").remove()})});var defaultCalendars=wpbs("div.wpbs-total-calendars").text();wpbs(window).resize(function(e){e.preventDefault(),console.log("window resize");var t=wpbs(window).width();defaultCalendars>1&&(t<768&&(wpbs("div.wpbs-total-calendars").text(1),wpbs("div.wpbs-container").each(function(){var e=wpbs(this),t=null;t=0==e.find(".wpbs-current-timestamp a").length?e.find(".wpbs-current-timestamp").html():e.find(".wpbs-current-timestamp a").html(),wpbs_changeDay("refresh",t,e)})),t>=768&&t<992&&(wpbs("div.wpbs-total-calendars").text(2),wpbs("div.wpbs-container").each(function(){var e=wpbs(this),t=null;t=0==e.find(".wpbs-current-timestamp a").length?e.find(".wpbs-current-timestamp").html():e.find(".wpbs-current-timestamp a").html(),wpbs_changeDay("refresh",t,e)})),t>=992&&(wpbs("div.wpbs-total-calendars").text(defaultCalendars),wpbs("div.wpbs-container").each(function(){var e=wpbs(this),t=null;t=0==e.find(".wpbs-current-timestamp a").length?e.find(".wpbs-current-timestamp").html():e.find(".wpbs-current-timestamp a").html(),wpbs_changeDay("refresh",t,e)})))}),$=jQuery.noConflict();