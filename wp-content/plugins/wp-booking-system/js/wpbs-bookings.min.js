wpbs(document).ready(function(){wpbs(".wpbs-bookings-status").each(function(){var a=wpbs(this),t=a.find(".wpbs-data-table").dataTable({bPaginate:!0,bLengthChange:!1,bFilter:!0,iDisplayLength:5,bSort:!1,oLanguage:{sEmptyTable:"No bookings in this section."},bInfo:!1,bAutoWidth:!1,fnDrawCallback:function(t){a.find(".wpbs-data-table-current").val(Math.ceil(t._iDisplayStart/t._iDisplayLength)+1),a.find(".wpbs-data-table-total").html(Math.ceil(t.fnRecordsDisplay()/t._iDisplayLength)),a.find(".wpbs-data-table-total-items").html(t.fnRecordsDisplay()+" items")}}),s=t.fnSettings();wpbs(a).on("keyup",".wpbs-data-table-current",function(){if((parseInt(wpbs(this).val())-1)*s._iDisplayLength<t.fnSettings().fnRecordsTotal()){var a=(parseInt(wpbs(this).val())-1)*s._iDisplayLength;s._iDisplayStart=a,wpbs(s.oInstance).trigger("page",s),s.oApi._fnCalculateEnd(s),s.oApi._fnDraw(s)}}),wpbs(a).on("click",".wpbs-data-table-next-page",function(){a.find(".paginate_enabled_next").click()}),wpbs(a).on("click",".wpbs-data-table-last-page",function(){s._iDisplayStart=(Math.ceil(s.fnRecordsDisplay()/s._iDisplayLength)-1)*s._iDisplayLength,wpbs(s.oInstance).trigger("page",s),s.oApi._fnCalculateEnd(s),s.oApi._fnDraw(s)}),wpbs(a).on("click",".wpbs-data-table-prev-page",function(){a.find(".paginate_enabled_previous").click()}),wpbs(a).on("click",".wpbs-data-table-first-page",function(){s._iDisplayStart=0,wpbs(s.oInstance).trigger("page",s),s.oApi._fnCalculateEnd(s),s.oApi._fnDraw(s)})}),wpbs(".wpbs-bookings-status").hide(),wpbs(".wpbs-bookings-container").on("click",".wpbs-bookings-tabs a",function(a){a.preventDefault(),wpbs(".wpbs-bookings-status").hide(),wpbs(wpbs(this).attr("href")).show(),wpbs(".wpbs-bookings-tabs a").removeClass("active"),wpbs(this).addClass("active"),"#wpbs-bookings-accepted"==wpbs(this).attr("href")&&(clickPage=Math.ceil(wpbs("#wpbs-past-accepted-bookings").html()/5),clickPage<1&&(clickPage=1),wpbs("#wpbs-bookings-accepted .wpbs-data-table-current").val(clickPage).trigger("keyup"))}),wpbs(".wpbs-bookings-tabs a:first").click(),wpbs(".wpbs-bookings-container").on("click",".wpbs-booking-open-options",function(a){if(a.preventDefault(),$parent=wpbs(this).parent(),$parent.hasClass("wpbs-booking-field-read-0")){$parent.removeClass("wpbs-booking-field-read-0");var t={bookingID:$parent.attr("id").replace("wpbs-booking-field-",""),action:"wpbs_bookingMarkAsRead"};wpbs.post(ajaxurl,t)}wpbs(".wpbs-booking-field.open .wpbs-booking-field-options").slideToggle(),$parent.hasClass("open")?wpbs(".wpbs-booking-field.open").removeClass("open"):(wpbs(".wpbs-booking-field.open").removeClass("open"),$parent.addClass("open"),$parent.find(".wpbs-booking-field-options").slideToggle())}),wpbs(".wpbs-button-delete").click(function(a){a.stopPropagation()}),wpbs(".wpbs-accept-booking").click(function(a){wpbs("#wpbs_send_confirmation_message").val(wpbs(".wpbs-modal-box .send-confirmation-message").val()),wpbs("#wpbs_confirmation_message").val(wpbs(".wpbs-modal-box .send-confirmation-message-additional").val()),wpbs(".wpbs-modal-overlay").fadeTo(300,0,function(){wpbs(".wpbs-modal-overlay").hide()})});var a="";wpbs(".wpbs-close-modal").click(function(t){wpbs(".wpbs-calendar-data").html(a),wpbs("#inputCalendarData").val(a),wpbs("#wpbs_booking_action, #wpbs_booking_id").val(""),wpbs(".wpbs-modal-overlay").fadeTo(300,0,function(){wpbs(".wpbs-modal-overlay").hide()})}),wpbs(".wpbs-bookings-container").on("click",".wpbs-button-accept",function(t){t.stopPropagation(),t.preventDefault(),a=wpbs(".wpbs-calendar-data").html(),$button=wpbs(this),$button.closest("td").addClass("wpbs-booking-selected"),wpbs(".wpbs-modal-box-container").html(""),wpbs("#wpbs_booking_action").val($button.attr("data-action")),wpbs("#wpbs_booking_id").val($button.attr("data-booking-id")),"accept"==$button.attr("data-action")&&(wpbs(".wpbs-accept-booking").html(wpbs_accept_booking),wpbs(".wpbs-modal-box-header h2").html(wpbs_accept_booking+" - "+wpbs_edit_availatility)),"delete"==$button.attr("data-action")&&(wpbs(".wpbs-accept-booking").html(wpbs_delete_booking),wpbs(".wpbs-modal-box-header h2").html(wpbs_delete_booking+" - "+wpbs_edit_availatility)),"edit"==$button.attr("data-action")&&(wpbs(".wpbs-accept-booking").html(wpbs_edit_booking),wpbs(".wpbs-modal-box-header h2").html(wpbs_edit_booking+" - "+wpbs_edit_availatility));var s=$button.closest("div.wpbs-bookings-status").attr("id").replace("wpbs-bookings-",""),o={startDate:$button.attr("data-start"),endDate:$button.attr("data-end"),calendarID:$button.attr("data-id"),bookingID:$button.attr("data-booking-id"),buttonAction:$button.attr("data-action"),from:s,action:"wpbs_bookingModalData"};wpbs.post(ajaxurl,o,function(a){wpbs(".wpbs-modal-box-container").html(a),wpbs(".wpbs-modal-overlay").css("opacity",0).show().fadeTo(300,1)})}),wpbs(document).on("change",".send-confirmation-message",function(a){1==wpbs(this).val()?wpbs(".send-confirmation-message-options").show():wpbs(".send-confirmation-message-options").hide()})});